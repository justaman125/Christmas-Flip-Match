<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Christmas Flip & Match</title>

<style>
* { box-sizing: border-box; font-family: "Segoe UI", sans-serif; }

body {
  margin: 0;
  min-height: 100vh;
  background: radial-gradient(circle at top, #1b5e20, #0d2818);
  color: #fff;
  display: flex;
  justify-content: center;
  align-items: center;
  overflow: hidden;
}

/* Snow */
.snow::before {
  content: "â„ â… â† â„ â… â†";
  position: absolute;
  top: -10%;
  left: 0;
  width: 100%;
  font-size: 2rem;
  opacity: 0.25;
  animation: snow 14s linear infinite;
}
@keyframes snow { to { transform: translateY(120vh); } }

/* Containers */
.screen {
  background: rgba(0,0,0,0.45);
  padding: 30px 40px;
  border-radius: 22px;
  box-shadow: 0 0 35px rgba(255,0,0,0.35);
  text-align: center;
}

.hidden { display: none; }

h1 {
  margin: 0;
  color: #ffeb3b;
  text-shadow: 0 0 12px red;
}

button {
  padding: 12px 26px;
  border-radius: 16px;
  border: none;
  background: #ff5252;
  color: white;
  cursor: pointer;
  font-size: 1rem;
  margin: 10px;
  box-shadow: 0 0 12px red;
}
button:hover { background: #ff1744; }

/* Game */
.scoreboard {
  display: flex;
  gap: 12px;
  margin: 20px 0;
}

.player {
  flex: 1;
  padding: 10px;
  border-radius: 14px;
  background: rgba(255,255,255,0.15);
}

.player.active {
  background: rgba(255,0,0,0.65);
  box-shadow: 0 0 15px #ff5252;
}

.grid {
  display: grid;
  grid-template-columns: repeat(4, 90px);
  gap: 15px;
  justify-content: center;
  margin: 20px 0;
}

.card {
  width: 90px;
  height: 110px;
  perspective: 800px;
  cursor: pointer;
}

.card-inner {
  width: 100%;
  height: 100%;
  transition: transform 0.6s;
  transform-style: preserve-3d;
  position: relative;
}

.card.flip .card-inner { transform: rotateY(180deg); }

.card-face {
  position: absolute;
  width: 100%;
  height: 100%;
  backface-visibility: hidden;
  border-radius: 15px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 2.6rem;
}

.card-front { background: linear-gradient(145deg,#c62828,#8e0000); }
.card-back {
  background: linear-gradient(145deg,#2e7d32,#1b5e20);
  transform: rotateY(180deg);
}

/* Winner */
.winner-box {
  background: #1b5e20;
  padding: 35px;
  border-radius: 22px;
  box-shadow: 0 0 35px gold;
}

.rank {
  opacity: 0;
  transform: translateY(20px);
  transition: all 0.6s ease;
  margin: 10px 0;
}
.rank.show { opacity: 1; transform: translateY(0); }
.rank.first { color: gold; font-size: 1.4rem; }
.rank.second { color: silver; }
.rank.third { color: #cd7f32; }

/* Confetti */
.confetti {
  position: fixed;
  width: 8px;
  height: 14px;
  background: red;
  top: -20px;
  animation: fall linear forwards;
}

@keyframes fall {
  to {
    transform: translateY(120vh) rotate(360deg);
    opacity: 0;
  }
}
</style>
</head>

<body>
<div class="snow"></div>

<!-- Player Select Screen -->
<div class="screen" id="menuScreen">
  <h1>ğŸ„ Christmas Flip & Match ğŸ„</h1>
  <h3>Select Players</h3>
  <button onclick="startGame(2)">ğŸ‘¥ 2 Players</button>
  <button onclick="startGame(3)">ğŸ‘¥ 3 Players</button>
</div>

<!-- Game Screen -->
<div class="screen hidden" id="gameScreen">
  <h1>ğŸ„ Christmas Flip & Match ğŸ„</h1>
  <div class="scoreboard" id="scoreboard"></div>
  <div class="grid" id="grid"></div>
  <button onclick="resetToMenu()">Back to Menu</button>
</div>

<!-- Winner Screen -->
<div class="screen hidden" id="winnerScreen">
  <div class="winner-box">
    <h2>ğŸ† Final Results</h2>
    <div id="results"></div>
    <button onclick="resetToMenu()">Play Again ğŸ</button>
  </div>
</div>

<script>
const emojis = ["ğŸ„","ğŸ","â­","â›„","ğŸ””","ğŸª","ğŸ•¯ï¸","ğŸ¦Œ"];

let NUM_PLAYERS = 2;
let scores = [];
let currentPlayer = 0;
let flipped = [];
let lock = false;
let matches = 0;

const menuScreen = document.getElementById("menuScreen");
const gameScreen = document.getElementById("gameScreen");
const winnerScreen = document.getElementById("winnerScreen");
const grid = document.getElementById("grid");
const scoreboard = document.getElementById("scoreboard");
const results = document.getElementById("results");

function shuffle(a){ return a.sort(()=>Math.random()-0.5); }

function startGame(players) {
  NUM_PLAYERS = players;
  scores = Array(NUM_PLAYERS).fill(0);
  currentPlayer = 0;
  matches = 0;
  flipped = [];

  menuScreen.classList.add("hidden");
  winnerScreen.classList.add("hidden");
  gameScreen.classList.remove("hidden");

  createScoreboard();
  createBoard();
}

function createScoreboard() {
  scoreboard.innerHTML = "";
  for (let i = 0; i < NUM_PLAYERS; i++) {
    const p = document.createElement("div");
    p.className = "player" + (i === 0 ? " active" : "");
    p.innerHTML = `Player ${i+1}: <span>0</span>`;
    scoreboard.appendChild(p);
  }
}

function createBoard() {
  grid.innerHTML = "";
  lock = false;

  const cards = shuffle([...emojis, ...emojis]);
  cards.forEach(e => {
    const c = document.createElement("div");
    c.className = "card";
    c.innerHTML = `
      <div class="card-inner">
        <div class="card-face card-front">â„</div>
        <div class="card-face card-back">${e}</div>
      </div>`;
    c.onclick = () => flip(c, e);
    grid.appendChild(c);
  });
}

function flip(card, emoji) {
  if (lock || card.classList.contains("flip")) return;
  card.classList.add("flip");
  flipped.push({ card, emoji });
  if (flipped.length === 2) check();
}

function check() {
  lock = true;
  const [a, b] = flipped;

  if (a.emoji === b.emoji) {
    scores[currentPlayer]++;
    updateScores();
    matches++;
    flipped = [];
    lock = false;

    if (matches === emojis.length) showResults();
  } else {
    setTimeout(() => {
      a.card.classList.remove("flip");
      b.card.classList.remove("flip");
      flipped = [];
      nextPlayer();
      lock = false;
    }, 900);
  }
}

function nextPlayer() {
  const players = document.querySelectorAll(".player");
  players[currentPlayer].classList.remove("active");
  currentPlayer = (currentPlayer + 1) % NUM_PLAYERS;
  players[currentPlayer].classList.add("active");
}

function updateScores() {
  document.querySelectorAll(".player span")
    .forEach((s, i) => s.textContent = scores[i]);
}

function showResults() {
  gameScreen.classList.add("hidden");
  winnerScreen.classList.remove("hidden");

  results.innerHTML = "";

  const ranking = scores
    .map((s,i)=>({player:i+1,score:s}))
    .sort((a,b)=>b.score-a.score);

  ranking.forEach((r,i)=>{
    const div=document.createElement("div");
    div.className=`rank ${i===0?"first":i===1?"second":"third"}`;
    div.textContent=`${i===0?"ğŸ¥‡":i===1?"ğŸ¥ˆ":"ğŸ¥‰"} Player ${r.player} â€” ${r.score} pts`;
    results.appendChild(div);
    setTimeout(()=>div.classList.add("show"), i*400);
  });

  launchConfetti();
}

function launchConfetti() {
  for (let i = 0; i < 120; i++) {
    const c = document.createElement("div");
    c.className = "confetti";
    c.style.left = Math.random() * 100 + "vw";
    c.style.background = ["red","gold","green","white"][Math.floor(Math.random()*4)];
    c.style.animationDuration = 2 + Math.random() * 2 + "s";
    document.body.appendChild(c);
    setTimeout(() => c.remove(), 4000);
  }
}

function resetToMenu() {
  menuScreen.classList.remove("hidden");
  gameScreen.classList.add("hidden");
  winnerScreen.classList.add("hidden");
}
</script>
</body>
</html>
