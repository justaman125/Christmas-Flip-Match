<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Christmas Flip & Match</title>

<style>
* {
  box-sizing: border-box;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
}

html, body {
  margin: 0;
  padding: 0;
  height: 100%;
  overflow: hidden;
}

body {
  background: radial-gradient(circle at top, #1b5e20, #0b1f13);
  color: white;
  display: flex;
  justify-content: center;
  align-items: center;
}

/* Snow overlay */
.snow::before {
  content: "â„ â… â† â„ â… â† â„ â… â†";
  position: fixed;
  top: -10%;
  width: 100%;
  font-size: 2rem;
  opacity: 0.25;
  animation: snow 16s linear infinite;
}
@keyframes snow {
  to { transform: translateY(120vh); }
}

/* Screens */
.screen {
  width: 100%;
  max-width: 1100px;
  max-height: 100vh;
  padding: 20px;
  background: rgba(0,0,0,0.45);
  border-radius: 24px;
  box-shadow: 0 0 40px rgba(255,0,0,0.35);
  text-align: center;
  overflow-y: auto;
}

.hidden { display: none; }

h1 {
  margin-top: 0;
  color: #ffeb3b;
  text-shadow: 0 0 12px red;
}

/* Buttons */
button {
  padding: 12px 22px;
  margin: 6px;
  border-radius: 16px;
  border: none;
  background: #ff5252;
  color: white;
  cursor: pointer;
  box-shadow: 0 0 12px red;
}
button:hover { background: #ff1744; }

/* Scoreboard */
.scoreboard {
  display: flex;
  gap: 10px;
  margin: 15px 0;
  flex-wrap: wrap;
}
.player {
  flex: 1;
  min-width: 130px;
  padding: 8px;
  border-radius: 14px;
  background: rgba(255,255,255,0.15);
}
.player.active {
  background: rgba(255,0,0,0.65);
  box-shadow: 0 0 15px #ff5252;
}

/* Grid */
.grid {
  display: grid;
  gap: 10px;
  justify-content: center;
  margin: 10px auto;
}

/* Card */
.card {
  aspect-ratio: 2 / 2.5;
  perspective: 900px;
  cursor: pointer;
}

.card-inner {
  width: 100%;
  height: 100%;
  transition: transform 0.55s;
  transform-style: preserve-3d;
  position: relative;
}

.card.flip .card-inner {
  transform: rotateY(180deg);
}

.card-face {
  position: absolute;
  inset: 0;
  backface-visibility: hidden;
  border-radius: 14px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: clamp(1.8rem, 3vw, 2.6rem);
}

.card-front {
  background: linear-gradient(145deg, #c62828, #8e0000);
}

.card-back {
  background: linear-gradient(145deg, #2e7d32, #1b5e20);
  transform: rotateY(180deg);
}

/* Winner */
.rank {
  opacity: 0;
  transform: translateY(20px);
  transition: all 0.6s ease;
  margin: 10px 0;
}
.rank.show { opacity: 1; transform: translateY(0); }
.rank.first { color: gold; font-size: 1.4rem; }
.rank.second { color: silver; }
.rank.third { color: #cd7f32; }

/* Confetti */
.confetti {
  position: fixed;
  width: 8px;
  height: 14px;
  top: -20px;
  animation: fall linear forwards;
}
@keyframes fall {
  to {
    transform: translateY(120vh) rotate(360deg);
    opacity: 0;
  }
}
</style>
</head>

<body>
<div class="snow"></div>

<!-- MENU -->
<div class="screen" id="menu">
  <h1>ğŸ„ Christmas Flip & Match ğŸ„</h1>

  <h3>Players</h3>
  <button onclick="players=2">2 Players</button>
  <button onclick="players=3">3 Players</button>

  <h3>Difficulty</h3>
  <button onclick="setDifficulty('easy')">Easy</button>
  <button onclick="setDifficulty('medium')">Medium</button>
  <button onclick="setDifficulty('hard')">Hard</button>
  <button onclick="setDifficulty('super')">ğŸ”¥ Super Hard</button>
  <button onclick="setDifficulty('insane')">ğŸ˜ˆ Insane</button>

  <br><br>
  <button onclick="startGame()">Start Game</button>
</div>

<!-- GAME -->
<div class="screen hidden" id="game">
  <h1>ğŸ„ Christmas Flip & Match ğŸ„</h1>
  <div class="scoreboard" id="scoreboard"></div>
  <div class="grid" id="grid"></div>
  <button onclick="backToMenu()">Back to Menu</button>
</div>

<!-- WINNER -->
<div class="screen hidden" id="winner">
  <h2>ğŸ† Final Results</h2>
  <div id="results"></div>
  <button onclick="backToMenu()">Play Again</button>
</div>

<script>
const EMOJIS = ["ğŸ„","ğŸ","â­","â›„","ğŸ””","ğŸª","ğŸ•¯ï¸","ğŸ¦Œ","â„ï¸","ğŸ…","ğŸ€","ğŸ­","ğŸ§¦","ğŸŒŸ","ğŸ›·","ğŸ¥¶","ğŸ¶","ğŸ”¥","ğŸ§£","â˜ƒï¸","ğŸ¬"];

let players = 2;
let difficulty = "easy";
let scores = [];
let currentPlayer = 0;
let flipped = [];
let lock = false;
let matches = 0;

let config = {};
let flipDelay = 900;

const menu = document.getElementById("menu");
const game = document.getElementById("game");
const winner = document.getElementById("winner");
const grid = document.getElementById("grid");
const scoreboard = document.getElementById("scoreboard");
const results = document.getElementById("results");

function setDifficulty(d){ difficulty = d; }

function startGame(){
  if(difficulty==="easy"){ config={cols:4,pairs:8}; flipDelay=1200; }
  if(difficulty==="medium"){ config={cols:5,pairs:10}; flipDelay=900; }
  if(difficulty==="hard"){ config={cols:6,pairs:15}; flipDelay=700; }
  if(difficulty==="super"){ config={cols:6,pairs:18}; flipDelay=500; }
  if(difficulty==="insane"){ config={cols:7,pairs:21}; flipDelay=350; }

  scores = Array(players).fill(0);
  currentPlayer = 0;
  matches = 0;
  flipped = [];

  menu.classList.add("hidden");
  winner.classList.add("hidden");
  game.classList.remove("hidden");

  createScoreboard();
  createGrid();
}

function createScoreboard(){
  scoreboard.innerHTML="";
  for(let i=0;i<players;i++){
    const d=document.createElement("div");
    d.className="player"+(i===0?" active":"");
    d.innerHTML=`Player ${i+1}: <span>0</span>`;
    scoreboard.appendChild(d);
  }
}

function createGrid(){
  grid.innerHTML="";
  grid.style.gridTemplateColumns = `repeat(${config.cols}, minmax(60px, 1fr))`;

  const size = Math.min(window.innerWidth, 1000) / config.cols - 14;
  grid.style.maxWidth = `${size*config.cols}px`;

  const deck=[...EMOJIS.slice(0,config.pairs),...EMOJIS.slice(0,config.pairs)]
    .sort(()=>Math.random()-0.5);

  deck.forEach(e=>{
    const c=document.createElement("div");
    c.className="card";
    c.style.width = `${size}px`;
    c.innerHTML=`
      <div class="card-inner">
        <div class="card-face card-front">â„</div>
        <div class="card-face card-back">${e}</div>
      </div>`;
    c.onclick=()=>flipCard(c,e);
    grid.appendChild(c);
  });
}

function flipCard(card,emoji){
  if(lock||card.classList.contains("flip"))return;
  card.classList.add("flip");
  flipped.push({card,emoji});
  if(flipped.length===2)checkMatch();
}

function checkMatch(){
  lock=true;
  const[a,b]=flipped;
  if(a.emoji===b.emoji){
    scores[currentPlayer]++;
    updateScores();
    matches++;
    flipped=[];
    lock=false;
    if(matches===config.pairs)showResults();
  } else {
    setTimeout(()=>{
      a.card.classList.remove("flip");
      b.card.classList.remove("flip");
      flipped=[];
      nextPlayer();
      lock=false;
    },flipDelay);
  }
}

function nextPlayer(){
  const ps=document.querySelectorAll(".player");
  ps[currentPlayer].classList.remove("active");
  currentPlayer=(currentPlayer+1)%players;
  ps[currentPlayer].classList.add("active");
}

function updateScores(){
  document.querySelectorAll(".player span")
    .forEach((s,i)=>s.textContent=scores[i]);
}

function showResults(){
  game.classList.add("hidden");
  winner.classList.remove("hidden");
  results.innerHTML="";

  scores.map((s,i)=>({p:i+1,s}))
    .sort((a,b)=>b.s-a.s)
    .forEach((r,i)=>{
      const d=document.createElement("div");
      d.className=`rank ${i===0?"first":i===1?"second":"third"}`;
      d.textContent=`${i===0?"ğŸ¥‡":i===1?"ğŸ¥ˆ":"ğŸ¥‰"} Player ${r.p} â€” ${r.s} pts`;
      results.appendChild(d);
      setTimeout(()=>d.classList.add("show"),i*400);
    });

  confetti();
}

function confetti(){
  for(let i=0;i<140;i++){
    const c=document.createElement("div");
    c.className="confetti";
    c.style.left=Math.random()*100+"vw";
    c.style.background=["red","gold","green","white"][Math.floor(Math.random()*4)];
    c.style.animationDuration=2+Math.random()*2+"s";
    document.body.appendChild(c);
    setTimeout(()=>c.remove(),4000);
  }
}

function backToMenu(){
  menu.classList.remove("hidden");
  game.classList.add("hidden");
  winner.classList.add("hidden");
}
</script>
</body>
</html>
